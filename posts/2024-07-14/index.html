<!DOCTYPE html>
<html lang="zh-tw" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="VarKai" />
	
	
	
	<title> ï½œ æ•¬å®‡å®™ğŸ¥‚ </title>
	
    
    
    <meta name="description" content="-&amp;ndash; title: &amp;ldquo;å¾®åšå›¾ç‰‡404 chatgptæ•™ä½ Rescue&amp;rdquo; date: 2024-07-14T20:09:47&#43;08:00 draft: false hidden: false draft: false tags: [&amp;ldquo;weibo&amp;rdquo;,&amp;ldquo;Python&amp;rdquo;,&amp;ldquo;chatgpt&amp;rdquo;] keywords: [] description: &amp;quot;&amp;quot; slug: &amp;quot;&amp;quot; -&amp;ndash; æ¥æº Tkæ•™ä¸» https://weibo.com/6827625527/Ong3JyBf4? https://weibo.com/1401527553/HDChc2ekA å¾®åšå¦‚ä½•è®¿é—®è¢«å¤¹çš„å›¾ç‰‡ â€“ Helious.wu&amp;rsquo;s Blog å…·ä½“å®ç° åŸç†åœ¨ä¸Šé¢è¿™ä½å¤§ä½¬" />
    

    
    
    <meta name="keywords" content="å®‡å®™, è‡ªæˆ‘, æ¢ç´¢, Crypto" />
    

	
    
    <link rel="shortcut icon" href="https://rosyriver.me/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://rosyriver.me/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://rosyriver.me/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://rosyriver.me/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="../../about/">é—œæ–¼æˆ‘</a>
            </li>
            
            <li>
                <a href="../../">å¯«å­—</a>
            </li>
            
            <li>
                <a href="../../posts/">è·³èˆ</a>
            </li>
            
            <li>
                <a href="../../tags/">å–é…’</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h2>
                <a href="https://rosyriver.me">
                    <span>æ•¬å®‡å®™ğŸ¥‚ </span>
                </a>
            </h2>
        </div>
        <div class="description">
            <p class="sub_title">æ˜¯ å¦ æœ‰ ç« ç‘° æ‚„ ç„¶ ç»½ æ”¾</p>
            <div class="my_socials">
                
                
                <a href="https://www.instagram.com/rosyr1ver/" title="instagram" target="_blank"><i class="ri-instagram-fill"></i></a>
                
                
                
                <a href="https://twitter.com/rosyr1ver" title="twitter" target="_blank"><i class="ri-twitter-fill"></i></a>
                
                
                
                <a href="https://weibo.com/rosyriver/" title="weibo" target="_blank"><i class="ri-weibo-fill"></i></a>
                
                
                 
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='../../posts/2024-07-14/'></a></h2>
                        <span class="date">0001.01.01</span>
                    </div>
                    <div class="post_content markdown"><p>-&ndash;</p>
<p>title: &ldquo;å¾®åšå›¾ç‰‡404  chatgptæ•™ä½ Rescue&rdquo;</p>
<p>date: 2024-07-14T20:09:47+08:00</p>
<p>draft: false</p>
<p>hidden: false</p>
<p>draft: false</p>
<p>tags: [&ldquo;weibo&rdquo;,&ldquo;Python&rdquo;,&ldquo;chatgpt&rdquo;]</p>
<p>keywords: []</p>
<p>description: &quot;&quot;</p>
<p>slug: &quot;&quot;</p>
<p>-&ndash;</p>
<p><em><!--**more**--></em></p>
<blockquote>
<p>æ¥æº</p>
<p>Tkæ•™ä¸» <a href="https://weibo.com/6827625527/Ong3JyBf4?">https://weibo.com/6827625527/Ong3JyBf4?</a></p>
<p><a href="https://weibo.com/1401527553/HDChc2ekA">https://weibo.com/1401527553/HDChc2ekA</a></p>
<p><a href="https://www.helious.xyz/2023/11/27/the-trick-about-access-deleted-photos-of-weibo/">å¾®åšå¦‚ä½•è®¿é—®è¢«å¤¹çš„å›¾ç‰‡ â€“ Helious.wu&rsquo;s Blog</a></p>
</blockquote>
<h3 id="å…·ä½“å®ç°">å…·ä½“å®ç°</h3>
<p>åŸç†åœ¨ä¸Šé¢è¿™ä½å¤§ä½¬çš„åšå®¢å…¶å®å·²ç»è¯´çš„å¾ˆæ¸…æ¥šäº†</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“å¦‚ä½•ä½¿ç”¨pythonå®ç°çš„</p>
<p>åŸæ–‡æ˜¯ä½¿ç”¨curlå®ç°çš„  å…¶ä¸­ä¸€ä¸ªå…³é”®çš„æ­¥éª¤æ˜¯ æŒ‡å®š&ndash;relsoveå°†è¯·æ±‚å›ºå®šåˆ° IP åœ°å€</p>
<hr>
<p>æˆ‘ä»¬æ¥é—®ä¸‹<strong>chatgpt</strong>:  <strong>curlä¸­&ndash;resolveçš„å‚æ•°  pythonä¸­æœ‰å®ç°å—</strong></p>
<p>ä»¥ä¸‹æ˜¯å¥¹çš„å›ç­”:</p>
<p><code>curl</code>ä¸­çš„ <code>--resolve</code> é€‰é¡¹å…è®¸ä½ å°†åŸŸåè§£æåˆ°ç‰¹å®šçš„IPåœ°å€ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨è°ƒè¯•å’Œæµ‹è¯•ç¯å¢ƒä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯ä»¥æŒ‡å®šåŸŸåè§£æè€Œä¸å¿…ä¿®æ”¹ç³»ç»Ÿçš„DNSè®¾ç½®ã€‚</p>
<p>åœ¨Pythonä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>http.client</code>åº“æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚è¿™éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„HTTPè¿æ¥å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨è¿æ¥æ—¶æŒ‡å®šè‡ªå®šä¹‰çš„ä¸»æœºå’Œç«¯å£ã€‚</p>
<h3 id="ç¤ºä¾‹ä½¿ç”¨httpclientå®ç°--resolve">ç¤ºä¾‹ï¼šä½¿ç”¨<code>http.client</code>å®ç°<code>--resolve</code></h3>
<p>å‡è®¾ä½ æœ‰ä»¥ä¸‹<code>curl</code>å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">curl --resolve example.com:443:1.2.3.4 https://example.com
</code></pre></div><p>è¿™æ„å‘³ç€ä½ å¸Œæœ›å°† <code>example.com</code> è§£æä¸º <code>1.2.3.4</code>ï¼Œå¹¶é€šè¿‡ HTTPS è®¿é—®å®ƒã€‚ä¸‹é¢æ˜¯å¦‚ä½•åœ¨Pythonä¸­å®ç°è¿™ä¸€ç‚¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">http.client</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="c1"># å®šä¹‰ç›®æ ‡åŸŸåå’ŒIPåœ°å€</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="s1">&#39;example.com&#39;</span>
<span class="n">resolved_ip</span> <span class="o">=</span> <span class="s1">&#39;1.2.3.4&#39;</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>

<span class="c1"># åˆ›å»ºSSLä¸Šä¸‹æ–‡</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>

<span class="c1"># åˆ›å»ºHTTPSè¿æ¥</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="n">resolved_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

<span class="c1"># è®¾ç½®è‡ªå®šä¹‰çš„ä¸»æœºå¤´</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Host&#39;</span><span class="p">:</span> <span class="n">hostname</span>
<span class="p">}</span>

<span class="c1"># å‘é€GETè¯·æ±‚</span>
<span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/&#34;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="c1"># è·å–å“åº”</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

<span class="c1"># å…³é—­è¿æ¥</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div><h3 id="è§£é‡Š">è§£é‡Š</h3>
<ol>
<li><strong>åˆ›å»ºSSLä¸Šä¸‹æ–‡</strong>ï¼š ä½¿ç”¨ <code>ssl.create_default_context()</code> æ¥åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„SSLä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡å°†ç”¨äºHTTPSè¿æ¥ã€‚</li>
<li><strong>åˆ›å»ºHTTPSè¿æ¥</strong>ï¼š ä½¿ç”¨ <code>http.client.HTTPSConnection</code> æ¥åˆ›å»ºä¸€ä¸ªHTTPSè¿æ¥å¯¹è±¡ï¼Œå¹¶æŒ‡å®šè§£æåçš„IPåœ°å€å’Œç«¯å£ã€‚</li>
<li><strong>è®¾ç½®è‡ªå®šä¹‰çš„ä¸»æœºå¤´</strong>ï¼š ä¸ºäº†è®©æœåŠ¡å™¨è¯†åˆ«è¯·æ±‚çš„åŸŸåï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® <code>Host</code> å­—æ®µä¸ºåŸå§‹åŸŸåã€‚</li>
<li><strong>å‘é€è¯·æ±‚å¹¶è·å–å“åº”</strong>ï¼š ä½¿ç”¨ <code>conn.request</code> å‘é€GETè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨ <code>conn.getresponse</code> è·å–æœåŠ¡å™¨å“åº”ã€‚</li>
</ol>
<h3 id="å…¶ä»–æ³¨æ„äº‹é¡¹">å…¶ä»–æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p><strong>SSLè¯ä¹¦éªŒè¯</strong>ï¼š ä¸Šè¿°ä»£ç åˆ›å»ºçš„SSLä¸Šä¸‹æ–‡é»˜è®¤ä¼šéªŒè¯æœåŠ¡å™¨çš„SSLè¯ä¹¦ã€‚å¦‚æœä½ åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œå¯èƒ½éœ€è¦ç¦ç”¨SSLéªŒè¯ã€‚è¿™å¯ä»¥é€šè¿‡ <code>ssl._create_unverified_context()</code> æ¥å®ç°ï¼Œä½†ä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚</p>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼š å®é™…åº”ç”¨ä¸­åº”è¯¥æ·»åŠ é”™è¯¯å¤„ç†é€»è¾‘ï¼Œä»¥åº”å¯¹å¯èƒ½çš„ç½‘ç»œå¼‚å¸¸å’ŒHTTPé”™è¯¯ã€‚</p>
</li>
</ul>
<p>è¿™ç§æ–¹æ³•å¯ä»¥å®ç°ç±»ä¼¼<code>curl --resolve</code>çš„åŠŸèƒ½ï¼Œå…è®¸ä½ åœ¨Pythonä¸­æŒ‡å®šåŸŸåè§£æåˆ°ç‰¹å®šçš„IPåœ°å€ï¼Œå¹¶å‘é€HTTP/HTTPSè¯·æ±‚ã€‚</p>
<hr>
<p>æˆ‘ä»¬éšæœºæ‰¾åˆ°ä¸€ä¸ª404çš„å¾®åšå›¾ç‰‡ï¼š</p>
<p>æŸ¥çœ‹å¯¹åº”çš„è¯·æ±‚å¹¶å°†å…¶å¤åˆ¶åˆ°postman, ç”Ÿæˆå¯¹åº”çš„http.clientä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">http.client</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="s2">&#34;wx3.sinaimg.cn&#34;</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8&#39;</span><span class="p">,</span>
  <span class="s1">&#39;accept-language&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#39;</span><span class="p">,</span>
  <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;u=1, i&#39;</span><span class="p">,</span>
  <span class="s1">&#39;referer&#39;</span><span class="p">:</span> <span class="s1">&#39;https://s.weibo.com/&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-ch-ua&#39;</span><span class="p">:</span> <span class="s1">&#39;&#34;Not/A)Brand&#34;;v=&#34;8&#34;, &#34;Chromium&#34;;v=&#34;126&#34;, &#34;Microsoft Edge&#34;;v=&#34;126&#34;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-ch-ua-mobile&#39;</span><span class="p">:</span> <span class="s1">&#39;?0&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-ch-ua-platform&#39;</span><span class="p">:</span> <span class="s1">&#39;&#34;Windows&#34;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-fetch-dest&#39;</span><span class="p">:</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-fetch-mode&#39;</span><span class="p">:</span> <span class="s1">&#39;no-cors&#39;</span><span class="p">,</span>
  <span class="s1">&#39;sec-fetch-site&#39;</span><span class="p">:</span> <span class="s1">&#39;cross-site&#39;</span><span class="p">,</span>
  <span class="s1">&#39;user-agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0&#39;</span>
<span class="p">}</span>
<span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/mw690/81d97f6dgy1hrg7uvj4b6j20u03w6tsr.jpg&#34;</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</code></pre></div><hr>
<p>å¦‚ä½•ä½ ä¸ä¼šå°†ç»“æœä¿å­˜ä¸ºå›¾ç‰‡ç»§ç»­é—®å¥¹ï¼š</p>
<p>æˆ‘è¯·æ±‚çš„æ˜¯ä¸ªå›¾ç‰‡å¦‚ä½•å°†è¿”å›çš„ç»“æœä¿å­˜</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="c1"># æ‰“å¼€æ–‡ä»¶ä»¥å†™å…¥äºŒè¿›åˆ¶æ•°æ®</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="mi">1024</span><span class="p">):</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å›¾ç‰‡ä¿å­˜æˆåŠŸ&#34;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</code></pre></div><hr>
<p>è·å–CDNçš„resolve_ip</p>
<p>ç™»å½•é˜¿é‡Œäº‘çš„æ‹¨æµ‹æŒ‚æ‰çš„å›¾ç‰‡é“¾æ¥   ç­‰å¾…10s  å¯¼å‡ºç»“æœä¸ºxlsx</p>
<p><a href="https://cloudmonitornext.console.aliyun.com/disposableTest">äº‘ç›‘æ§ CloudMonitor (aliyun.com)</a></p>
<p>æˆ‘ä»¬è¿™é‡Œè¦éå†è¡¨æ ¼é‡Œçš„æ‰€æœ‰ip,  æ¥ç€é—®ï¼šå¦‚ä½•ä½¿ç”¨pythonéå†excelä¸­çš„æŸåˆ—</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">åœ¨Pythonä¸­ï¼Œéå†Excelæ–‡ä»¶ä¸­çš„æŸä¸€åˆ—å¯ä»¥ä½¿ç”¨<span class="sb">`</span>pandas<span class="sb">`</span>åº“ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºå¦‚ä½•è¯»å–Excelæ–‡ä»¶å¹¶éå†å…¶ä¸­çš„ä¸€åˆ—ã€‚

é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº†<span class="sb">`</span>pandas<span class="sb">`</span>åº“å’Œ<span class="sb">`</span>openpyxl<span class="sb">`</span>åº“ï¼š

<span class="sb">```</span>bash
pip install pandas openpyxl
<span class="sb">```</span>

ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥éå†Excelæ–‡ä»¶ä¸­çš„æŸä¸€åˆ—ï¼š

<span class="sb">```</span>python
import pandas as pd

<span class="c1"># è¯»å–Excelæ–‡ä»¶</span>
<span class="nv">file_path</span> <span class="o">=</span> <span class="s1">&#39;your_excel_file.xlsx&#39;</span>
<span class="nv">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Sheet1&#39;</span>  <span class="c1"># æ›¿æ¢ä¸ºä½ çš„å·¥ä½œè¡¨åç§°</span>
<span class="nv">column_name</span> <span class="o">=</span> <span class="s1">&#39;Column1&#39;</span>  <span class="c1"># æ›¿æ¢ä¸ºä½ è¦éå†çš„åˆ—å</span>

<span class="c1"># ä½¿ç”¨pandasè¯»å–Excelæ–‡ä»¶</span>
<span class="nv">df</span> <span class="o">=</span> pd.read_excel<span class="o">(</span>file_path, <span class="nv">sheet_name</span><span class="o">=</span>sheet_name<span class="o">)</span>

<span class="c1"># éå†æŒ‡å®šåˆ—</span>
<span class="k">for</span> value in df<span class="o">[</span>column_name<span class="o">]</span>:
    print<span class="o">(</span>value<span class="o">)</span>
<span class="sb">```</span>

<span class="c1">### è§£é‡Š</span>

1. **å¯¼å…¥<span class="sb">`</span>pandas<span class="sb">`</span>åº“**ï¼š<span class="sb">`</span>pandas<span class="sb">`</span>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®å¤„ç†åº“ï¼Œ<span class="sb">`</span>openpyxl<span class="sb">`</span>æ˜¯ä¸€ä¸ªç”¨äºè¯»å–Excelæ–‡ä»¶çš„å¼•æ“ã€‚
2. **è¯»å–Excelæ–‡ä»¶**ï¼šä½¿ç”¨<span class="sb">`</span>pd.read_excel<span class="sb">`</span>å‡½æ•°è¯»å–Excelæ–‡ä»¶ã€‚ä½ éœ€è¦æä¾›æ–‡ä»¶è·¯å¾„å’Œå·¥ä½œè¡¨åç§°ã€‚
3. **éå†åˆ—**ï¼šé€šè¿‡<span class="sb">`</span>df<span class="o">[</span>column_name<span class="o">]</span><span class="sb">`</span>å¯ä»¥è·å–æŒ‡å®šåˆ—çš„æ•°æ®ï¼Œç„¶åä½¿ç”¨<span class="sb">`</span><span class="k">for</span><span class="sb">`</span>å¾ªç¯éå†è¯¥åˆ—ã€‚

<span class="c1">### ç¤ºä¾‹Excelæ–‡ä»¶</span>

å‡è®¾ä½ çš„Excelæ–‡ä»¶<span class="sb">`</span>your_excel_file.xlsx<span class="sb">`</span>æœ‰ä¸€ä¸ªå·¥ä½œè¡¨<span class="sb">`</span>Sheet1<span class="sb">`</span>ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹æ•°æ®ï¼š

<span class="p">|</span> Column1 <span class="p">|</span> Column2 <span class="p">|</span>
<span class="p">|</span>---------<span class="p">|</span>---------<span class="p">|</span>
<span class="p">|</span> A       <span class="p">|</span> <span class="m">1</span>       <span class="p">|</span>
<span class="p">|</span> B       <span class="p">|</span> <span class="m">2</span>       <span class="p">|</span>
<span class="p">|</span> C       <span class="p">|</span> <span class="m">3</span>       <span class="p">|</span>

è¿è¡Œä¸Šè¿°ä»£ç åï¼Œè¾“å‡ºå°†æ˜¯ï¼š

<span class="sb">```</span>
A
B
C
<span class="sb">```</span>

è¿™æ ·ä½ å°±å¯ä»¥éå†Excelæ–‡ä»¶ä¸­çš„æŒ‡å®šåˆ—äº†ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…¶ä»–é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼
</code></pre></div><hr>
<p>æœ€ç»ˆå°†chatgptå’Œpostmanç”Ÿæˆçš„ä»£ç ç»“åˆå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">http.client</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># è¯»å–Excelæ–‡ä»¶</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;111.xlsx&#39;</span>
<span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;page1&#39;</span>  <span class="c1"># æ›¿æ¢ä¸ºä½ çš„å·¥ä½œè¡¨åç§°</span>
<span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;è§£æç»“æœIP&#39;</span>  <span class="c1"># æ›¿æ¢ä¸ºä½ è¦éå†çš„åˆ—å</span>

<span class="c1"># ä½¿ç”¨pandasè¯»å–Excelæ–‡ä»¶</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>

<span class="c1"># éå†æŒ‡å®šåˆ—</span>
<span class="k">for</span> <span class="n">resolved_ip</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]:</span>

    <span class="c1"># å®šä¹‰ç›®æ ‡åŸŸåå’ŒIPåœ°å€</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="s1">&#39;wx3.sinaimg.cn&#39;</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>


<span class="c1"># &#34;orj360&#34;,</span>
    
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/mw690/81d97f6dgy1hrg7uvj4b6j20u03w6tsr.jpg&#39;</span>

    <span class="c1"># åˆ›å»ºSSLä¸Šä¸‹æ–‡</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>

    <span class="c1"># åˆ›å»ºHTTPSè¿æ¥</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="n">resolved_ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>

    <span class="c1"># è®¾ç½®è‡ªå®šä¹‰çš„ä¸»æœºå¤´</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Host&#39;</span><span class="p">:</span> <span class="n">hostname</span><span class="p">,</span>
        <span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;accept-language&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="s1">&#39;u=1, i&#39;</span><span class="p">,</span>
    <span class="s1">&#39;referer&#39;</span><span class="p">:</span> <span class="s1">&#39;https://s.weibo.com/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-ch-ua&#39;</span><span class="p">:</span> <span class="s1">&#39;&#34;ndNot/A)Bra&#34;;v=&#34;8&#34;, &#34;Chromium&#34;;v=&#34;126&#34;, &#34;Microsoft Edge&#34;;v=&#34;126&#34;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-ch-ua-mobile&#39;</span><span class="p">:</span> <span class="s1">&#39;?0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-ch-ua-platform&#39;</span><span class="p">:</span> <span class="s1">&#39;&#34;Windows&#34;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-fetch-dest&#39;</span><span class="p">:</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-fetch-mode&#39;</span><span class="p">:</span> <span class="s1">&#39;no-cors&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sec-fetch-site&#39;</span><span class="p">:</span> <span class="s1">&#39;cross-site&#39;</span><span class="p">,</span>
    <span class="s1">&#39;user-agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0&#39;</span>
    <span class="p">}</span>

    <span class="c1"># å‘é€GETè¯·æ±‚</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="c1"># è·å–å“åº”</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>

    <span class="c1"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="c1"># æ‰“å¼€æ–‡ä»¶ä»¥å†™å…¥äºŒè¿›åˆ¶æ•°æ®</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">resolved_ip</span><span class="si">}</span><span class="s1">404.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å›¾ç‰‡ä¿å­˜æˆåŠŸ&#34;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>


    <span class="c1"># å…³é—­è¿æ¥</span>

    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</code></pre></div></div>
                    <div class="post_footer">
                        
                    </div>
                </div>
                
                
                
<div class="doc_comments">
    <div class="comments_block_title">å‘è¡¨è¯„è®º</div>
    <div id="vcomments"></div>
</div>

<link rel="stylesheet" href="https://rosyriver.me/css/comments.css" />
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        appId: 'dX98xUiMrgPkFDRneWlbVOw6-gzGzoHsz',
        appKey: 'YVqhhRJRpM3A90uJptl51zLN',
        placeholder: 'say some shit. ',
        visitor: 'true',
    })
</script>
                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="footer_slogan">
        <span>Born to roam ./</span>
    </div>
</footer>
    <script src="https://rosyriver.me/js/jquery-3.5.1.min.js"></script>
<link href="https://rosyriver.me/css/fancybox.min.css" rel="stylesheet">
<script src="https://rosyriver.me/js/fancybox.min.js"></script>
<script src="https://rosyriver.me/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', '0irY3ZV8SneLMRhGd-QGcg', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>